<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Page Title</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='main.css'>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script><style type="text/css" id="operaUserStyle"></style>
	<script src="http://servicios.usig.buenosaires.gov.ar/usig-js/2.0/usig.AutoCompleterFull.min.js" type="text/javascript"></script>
	<script src="http://servicios.usig.buenosaires.gov.ar/usig-js/2.0/usig.MapaEstatico.min.js" type="text/javascript"></script>
	<script type="text/javascript">	
	$(document).ready(function() {
		
		function afterGeoCoding(pt) {
			var imgMapa = usig.MapaEstatico({ x: pt.getX(), y: pt.getY(), marcarPunto: 1, width: 600, desc: $('#b').val() });
			imgMapa.onload = function() {
				$('#mapa').html('');
				$('#mapa').append(imgMapa);
			}
			$('#mapa').html('Cargando mapa centrado en '+pt+'...');		
		}
		
		$('#b').val('Cargando...').attr('disabled', 'disabled');
		
		var ac = new usig.AutoCompleter('b', {
	        		debug: true,
	        		skin: 'usig',
	        		useInventario: true,
	        		onReady: function() {
	        			$('#b').val('').removeAttr('disabled').focus();	        			
	        		},
	        		afterSelection: function(option) {
	        			$('#mapa').html('Se seleccionó la opción: '+option);
	        			if (option instanceof usig.Direccion || option instanceof usig.inventario.Objeto) {
	        				if ($('#mainForm fieldset input[name=geocode]').is(':checked'))
	        					$('#mapa').html('Buscando coordenadas...');
	        			}
	        		},
	        		afterGeoCoding: afterGeoCoding
	        	});
	        	
		$('#mainForm').bind("submit", function () {
			return false;
		});
		
		var options = ac.getOptions();
		$.each(options, function(k, v) {
			if ($('#mainForm fieldset input[name='+k+']').length > 0) {
				if ($('#mainForm fieldset input[name='+k+']').attr("type") == "checkbox") {
					$('#mainForm fieldset input[name='+k+']').attr('checked', v);
				} else {
					$('#mainForm fieldset input[name='+k+']').val(v);
				}
			}
			$('#mainForm fieldset select[name=skin]').val(options.skin);
		});
		
		$('#mainForm fieldset input').change(function(ev) {
			var options = {};
			if ($(this).attr("type") == "checkbox") {
				options[$(this).attr('name')] = $(this).is(':checked'); 
			} else {			
				options[$(this).attr('name')] = $(this).val(); 
			}
			if ($(this).attr('name') == "geocode") {
				options.afterGeoCoding = $(this).is(':checked')?afterGeoCoding:null;
			}
			ac.setOptions(options);
		});
		$('#mainForm fieldset select').change(function(ev) {
			ac.changeSkin($('#mainForm fieldset select[name=skin]').val());		
		});
	});	
	</script>
</head>

<body>
    <header class="header">
        <div class="titulo">
        <h4>Microemprendimientos</h4>
        </div>
        <nav>
            <ul class="menu">
                <li class="menu-item"><a href="#inicio">Inicio</a></li>
                <li class="menu-item"><a href="#contacti">Contacto</a></li>
                <li class="menu-item"><a href="#ds">Ds</a></li>
                <li class="menu-item"><a href="#sdf">Sdf</a></li>
            </ul>
        </nav>
    </header>
<div class="buscador">
    <form action="/search" method="get">
        <label for="b">Direccion</label>
        <input type="text" size="40" name="b" id="b" title="Lugar a buscar" class="text" autocomplete="off">
        <span id="ejemplo">indicar nombre de calle y altura</span>
      </form>
    </form>

</div>

</body>

</html>